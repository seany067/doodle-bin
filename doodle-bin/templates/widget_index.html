<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" type="text/css" href="/static/css/styles.css" />
    <script type="text/javascript" src="/static/js/paper-full.min.js"></script>
    <script type="text/javascript">
        let origin = window.location.origin;
        paper.install(window);
        let urlParts = window.location.pathname.split("/");
        window.onload = () => {
            let urlParts = window.location.pathname.split("/");
            fetch(`${origin}/load/${urlParts[urlParts.length - 1]}`, {
                method: 'GET',
                headers: {
                    "Content-Type": "application/json"
                }
            }).then((res) => {
                if (res.ok) {
                    return res.json()
                } else {
                    return null;
                }
            }).then((project) => {
                if (project !== null) {
                    let p = JSON.parse(project["content"])
                    paper.project.importJSON(p);
                }
            }).finally(() => {
                project.currentStyle = {
                    strokeColor: '#000000',
                    fillColor: 'transparent',
                    strokeWidth: 1
                }
                let svg = paper.project.exportSVG();
                document.getElementsByClassName("embedly-card")[0].appendChild(svg);
                document.getElementById("mainCanvas").hidden = "hidden";
            });

            paper.setup("mainCanvas");
            let tool = new Tool();
            let myPath;
        }
    </script>
</head>

<body>
    <canvas id="mainCanvas" resize></canvas>
    <blockquote class="embedly-card"></blockquote>
    <script async src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script>
</body>

</html>